<script>
    // ==================== Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ø³Ø±Ø§Ø³Ø±ÛŒ ====================
    const restaurantSlug = "{{ restaurant.slug }}";
    let currentAudio = null;
    let selectedFoods = JSON.parse(localStorage.getItem('selectedFoods_' + restaurantSlug)) || [];
    let startX = 0;
    let currentX = 0;
    let isDragging = false;

    // Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ø±Ø²Ø±Ùˆ
    let currentReservation = {
        tableId: null,
        date: null,
        startTime: null,
        endTime: null,
        guestCount: 2,
        reservationCode: null
    };

    // ==================== Ù…Ø¯ÛŒØ±ÛŒØª ØªÙ… ====================
    function initializeTheme() {
        const themeToggle = document.getElementById('theme-toggle');
        if (themeToggle) {
            themeToggle.addEventListener('click', () => {
                document.body.classList.toggle('dark-mode');
                const icon = themeToggle.querySelector('i');
                if (document.body.classList.contains('dark-mode')) {
                    icon.classList.remove('fa-moon');
                    icon.classList.add('fa-sun');
                    localStorage.setItem('theme', 'dark');
                } else {
                    icon.classList.remove('fa-sun');
                    icon.classList.add('fa-moon');
                    localStorage.setItem('theme', 'light');
                }
            });

            // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØªÙ… Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-mode');
                themeToggle.querySelector('i').classList.remove('fa-moon');
                themeToggle.querySelector('i').classList.add('fa-sun');
            }
        }
    }

    // ==================== Ù…Ø¯ÛŒØ±ÛŒØª Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§ ====================
    function initializeCategories() {
        const categoryButtons = document.querySelectorAll('.category-bottom-item, .slider-category-item');
        const foodItems = document.querySelectorAll('.food-item');

        function filterByCategory(categoryId) {
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ UI
            categoryButtons.forEach(btn => {
                btn.classList.remove('category-bottom-active', 'slider-category-active');
            });

            // ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ·Ù‡
            document.querySelectorAll(`[data-category="${categoryId}"]`).forEach(btn => {
                if(btn.classList.contains('category-bottom-item')) {
                    btn.classList.add('category-bottom-active');
                } else {
                    btn.classList.add('slider-category-active');
                }
            });

            // ÙÛŒÙ„ØªØ± ØºØ°Ø§Ù‡Ø§
            foodItems.forEach(item => {
                const itemCategory = item.getAttribute('data-category');
                if (categoryId === 'all' || itemCategory === categoryId) {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
        }

        categoryButtons.forEach(button => {
            button.addEventListener('click', function() {
                const categoryId = this.getAttribute('data-category');
                filterByCategory(categoryId);

                // Ø¨Ø³ØªÙ† Ù…Ù†ÙˆÛŒ Ú©Ø´ÙˆÛŒÛŒ Ø§Ú¯Ø± Ø¨Ø§Ø² Ø§Ø³Øª
                const categoriesSlider = document.querySelector('.categories-slider');
                if(categoriesSlider && categoriesSlider.classList.contains('open')) {
                    toggleCategoriesSlider();
                }
            });
        });

        // ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø¯Ø³ØªÙ‡ "Ù‡Ù…Ù‡" Ø¨Ù‡ ØµÙˆØ±Øª Ù¾ÛŒØ´â€ŒÙØ±Ø¶
        const allCategoryBtn = document.querySelector('[data-category="all"]');
        if (allCategoryBtn) {
            filterByCategory('all');
        }
    }

    // ==================== Ù…Ø¯ÛŒØ±ÛŒØª Ø¬Ø³ØªØ¬Ùˆ ====================
    function initializeSearch() {
        const searchInput = document.querySelector('.search-box input');
        const foodItems = document.querySelectorAll('.food-item');
        let searchTimeout;

        if (searchInput) {
            searchInput.addEventListener('input', (e) => {
                const query = e.target.value.trim().toLowerCase();
                clearTimeout(searchTimeout);

                searchTimeout = setTimeout(() => {
                    foodItems.forEach(item => {
                        const title = item.querySelector('.food-title').textContent.toLowerCase();
                        const description = item.querySelector('.food-description').textContent.toLowerCase();

                        if (title.includes(query) || description.includes(query)) {
                            item.style.display = 'block';
                        } else {
                            item.style.display = 'none';
                        }
                    });

                    // Ø§Ú¯Ø± Ø¬Ø³ØªØ¬Ùˆ Ø®Ø§Ù„ÛŒ Ø´Ø¯ØŒ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ ÙØ¹Ø§Ù„ Ø±Ø§ Ù†Ø´Ø§Ù† Ø¨Ø¯Ù‡
                    if (query === '') {
                        const activeCategory = document.querySelector('.category-bottom-active');
                        if (activeCategory) {
                            const categoryId = activeCategory.getAttribute('data-category');
                            const categoryButtons = document.querySelectorAll('.category-bottom-item, .slider-category-item');
                            categoryButtons.forEach(btn => {
                                if (btn.getAttribute('data-category') === categoryId) {
                                    btn.click();
                                }
                            });
                        }
                    }
                }, 300);
            });
        }
    }

    // ==================== Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ù†ÙˆÛŒ Ú©Ø´ÙˆÛŒÛŒ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§ ====================
    function initializeCategoriesSlider() {
        const categoriesSlider = document.querySelector('.categories-slider');
        const categoriesToggle = document.querySelector('.categories-toggle');
        const sliderClose = document.querySelector('.slider-close');
        const overlay = document.querySelector('.overlay');
        const dragHandle = document.querySelector('.drag-handle');

        if (!categoriesSlider || !categoriesToggle) return;

        function toggleCategoriesSlider() {
            categoriesSlider.classList.toggle('open');
            overlay.classList.toggle('active');

            const icon = categoriesToggle.querySelector('i');
            if (categoriesSlider.classList.contains('open')) {
                icon.classList.remove('fa-chevron-right');
                icon.classList.add('fa-chevron-left');
            } else {
                icon.classList.remove('fa-chevron-left');
                icon.classList.add('fa-chevron-right');
            }
        }

        // Event Listeners
        categoriesToggle.addEventListener('click', toggleCategoriesSlider);
        if (sliderClose) {
            sliderClose.addEventListener('click', toggleCategoriesSlider);
        }
        if (overlay) {
            overlay.addEventListener('click', toggleCategoriesSlider);
        }

        // Ù‚Ø§Ø¨Ù„ÛŒØª Ú©Ø´ÛŒØ¯Ù†
        if (dragHandle) {
            dragHandle.addEventListener('mousedown', startDrag);
            dragHandle.addEventListener('touchstart', startDrag);
        }

        function startDrag(e) {
            e.preventDefault();
            isDragging = true;
            startX = e.type === 'mousedown' ? e.clientX : e.touches[0].clientX;
            currentX = startX;

            document.addEventListener('mousemove', onDrag);
            document.addEventListener('touchmove', onDrag);
            document.addEventListener('mouseup', endDrag);
            document.addEventListener('touchend', endDrag);

            categoriesSlider.style.transition = 'none';
        }

        function onDrag(e) {
            if (!isDragging) return;

            e.preventDefault();
            currentX = e.type === 'mousedown' ? e.clientX : e.touches[0].clientX;
            const diff = startX - currentX;

            if (diff < 0) {
                const newRight = Math.min(0, -diff);
                categoriesSlider.style.right = `${newRight}px`;
            }
        }

        function endDrag() {
            if (!isDragging) return;

            isDragging = false;
            categoriesSlider.style.transition = 'right 0.3s ease';

            const diff = startX - currentX;
            const threshold = 100;

            if (diff > threshold) {
                categoriesSlider.style.right = '-320px';
                setTimeout(() => {
                    categoriesSlider.classList.remove('open');
                    overlay.classList.remove('active');

                    const icon = categoriesToggle.querySelector('i');
                    icon.classList.remove('fa-chevron-left');
                    icon.classList.add('fa-chevron-right');
                }, 300);
            } else {
                categoriesSlider.style.right = '0';
            }

            document.removeEventListener('mousemove', onDrag);
            document.removeEventListener('touchmove', onDrag);
            document.removeEventListener('mouseup', endDrag);
            document.removeEventListener('touchend', endDrag);
        }
    }

    // ==================== Ù…Ø¯ÛŒØ±ÛŒØª ØµØ¯Ø§ ====================
    function initializeSound() {
        document.addEventListener('click', (e) => {
            if (e.target.closest('.sound-btn')) {
                const soundBtn = e.target.closest('.sound-btn');
                const soundUrl = soundBtn.getAttribute('data-sound');

                if (!soundUrl) {
                    showNotification('ØªÙˆØ¶ÛŒØ­Ø§Øª ØµÙˆØªÛŒ Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† ØºØ°Ø§ Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛŒØ³Øª');
                    return;
                }

                // Ø§Ú¯Ø± Ù‡Ù…ÛŒÙ† ØµØ¯Ø§ Ø¯Ø± Ø­Ø§Ù„ Ù¾Ø®Ø´ Ø§Ø³ØªØŒ Ù…ØªÙˆÙ‚Ù Ú©Ù†
                if (currentAudio && soundBtn.classList.contains('playing')) {
                    currentAudio.pause();
                    currentAudio.currentTime = 0;
                    soundBtn.classList.remove('playing');
                    showNotification('Ù¾Ø®Ø´ ØµØ¯Ø§ Ù…ØªÙˆÙ‚Ù Ø´Ø¯');
                    return;
                }

                // Ø§Ú¯Ø± ØµØ¯Ø§Ù‡Ø§ÛŒ Ø¯ÛŒÚ¯Ø± Ø¯Ø± Ø­Ø§Ù„ Ù¾Ø®Ø´ Ù‡Ø³ØªÙ†Ø¯ØŒ Ù…ØªÙˆÙ‚Ù Ú©Ù†
                if (currentAudio && !currentAudio.paused) {
                    currentAudio.pause();
                    currentAudio.currentTime = 0;
                    document.querySelectorAll('.sound-btn').forEach(btn => {
                        btn.classList.remove('playing');
                    });
                }

                // Ù¾Ø®Ø´ ØµØ¯Ø§
                try {
                    currentAudio = new Audio(soundUrl);
                    currentAudio.play().then(() => {
                        soundBtn.classList.add('playing');
                        showNotification('Ø¯Ø± Ø­Ø§Ù„ Ù¾Ø®Ø´ ØªÙˆØ¶ÛŒØ­Ø§Øª ØµÙˆØªÛŒ...');
                    }).catch(error => {
                        console.error('Error playing sound:', error);
                        showNotification('Ø®Ø·Ø§ Ø¯Ø± Ù¾Ø®Ø´ ØµØ¯Ø§');
                    });

                    currentAudio.addEventListener('ended', () => {
                        soundBtn.classList.remove('playing');
                        showNotification('Ù¾Ø®Ø´ ØªÙˆØ¶ÛŒØ­Ø§Øª ØµÙˆØªÛŒ Ø¨Ù‡ Ù¾Ø§ÛŒØ§Ù† Ø±Ø³ÛŒØ¯');
                    });

                    currentAudio.addEventListener('error', () => {
                        soundBtn.classList.remove('playing');
                        showNotification('Ø®Ø·Ø§ Ø¯Ø± Ù¾Ø®Ø´ ÙØ§ÛŒÙ„ ØµÙˆØªÛŒ');
                    });

                } catch (error) {
                    console.error('Error creating audio:', error);
                    showNotification('Ø®Ø·Ø§ Ø¯Ø± Ø§ÛŒØ¬Ø§Ø¯ Ù¾Ø®Ø´ Ú©Ù†Ù†Ø¯Ù‡ ØµØ¯Ø§');
                }
            }
        });
    }

    // ==================== Ù…Ø¯ÛŒØ±ÛŒØª Ù„ÛŒØ³Øª Ø§Ù†ØªØ®Ø§Ø¨ ØºØ°Ø§ ====================
   function initializeSelectionList() {
    const selectionListBtn = document.querySelector('.selection-list-btn');
    const selectionListPanel = document.querySelector('.selection-list-panel');
    const selectionListClose = document.querySelector('.selection-list-close');
    const selectionListShow = document.querySelector('.selection-list-show');
    const selectionListClear = document.querySelector('.selection-list-clear');
    const selectionDisplay = document.querySelector('.selection-display');
    const selectionDisplayClose = document.querySelector('.selection-display-close');
    const selectionDisplayBack = document.querySelector('.selection-display-back');
    const selectionDisplayCall = document.querySelector('.selection-display-call');
    const overlay = document.querySelector('.overlay');

    // Ø¨Ø§Ø² Ú©Ø±Ø¯Ù†/Ø¨Ø³ØªÙ† Ù¾Ù†Ù„ Ù„ÛŒØ³Øª Ø§Ù†ØªØ®Ø§Ø¨
    if (selectionListBtn) {
        selectionListBtn.addEventListener('click', () => {
            selectionListPanel.classList.add('open');
            overlay.classList.add('active');
            document.body.style.overflow = 'hidden'; // Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø§Ø³Ú©Ø±ÙˆÙ„
        });
    }

    // Ø¨Ø³ØªÙ† Ù¾Ù†Ù„ Ù„ÛŒØ³Øª Ø§Ù†ØªØ®Ø§Ø¨
    function closeSelectionListPanel() {
        selectionListPanel.classList.remove('open');
        overlay.classList.remove('active');
        document.body.style.overflow = ''; // Ø¨Ø§Ø²Ú¯Ø±Ø¯Ø§Ù†Ø¯Ù† Ø§Ø³Ú©Ø±ÙˆÙ„
    }

    if (selectionListClose) {
        selectionListClose.addEventListener('click', closeSelectionListPanel);
    }

    // Ù†Ù…Ø§ÛŒØ´ Ø¨Ù‡ Ú¯Ø§Ø±Ø³ÙˆÙ† - Ø§ÛŒÙ† Ø¨Ø®Ø´ Ø§ØµÙ„Ø§Ø­ Ø´Ø¯Ù‡
    if (selectionListShow) {
        selectionListShow.addEventListener('click', () => {
            if (selectedFoods.length === 0) {
                showNotification('Ù„ÛŒØ³Øª Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ù…Ø§ Ø®Ø§Ù„ÛŒ Ø§Ø³Øª');
                return;
            }

            // Ø§Ø¨ØªØ¯Ø§ Ù¾Ù†Ù„ Ù„ÛŒØ³Øª Ø±Ø§ Ø¨Ø¨Ù†Ø¯
            closeSelectionListPanel();

            // Ø³Ù¾Ø³ ØµÙØ­Ù‡ Ù†Ù…Ø§ÛŒØ´ Ø±Ø§ Ø¨Ø§Ø² Ú©Ù†
            setTimeout(() => {
                selectionDisplay.classList.add('open');
                overlay.classList.add('active'); // overlay Ø±Ø§ ÙØ¹Ø§Ù„ Ú©Ù†
                document.body.style.overflow = 'hidden'; // Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø§Ø³Ú©Ø±ÙˆÙ„
            }, 300);

            updateSelectionDisplay();
        });
    }

    // Ø¨Ø³ØªÙ† ØµÙØ­Ù‡ Ù†Ù…Ø§ÛŒØ´ - Ø§ÛŒÙ† Ø¨Ø®Ø´ Ø§ØµÙ„Ø§Ø­ Ø´Ø¯Ù‡
    function closeSelectionDisplay() {
        selectionDisplay.classList.remove('open');
        overlay.classList.remove('active'); // overlay Ø±Ø§ ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ù†
        document.body.style.overflow = ''; // Ø¨Ø§Ø²Ú¯Ø±Ø¯Ø§Ù†Ø¯Ù† Ø§Ø³Ú©Ø±ÙˆÙ„
    }

    if (selectionDisplayClose) {
        selectionDisplayClose.addEventListener('click', closeSelectionDisplay);
    }

    // Ø¨Ø§Ø²Ú¯Ø´Øª Ø§Ø² ØµÙØ­Ù‡ Ù†Ù…Ø§ÛŒØ´ - Ø§ÛŒÙ† Ø¨Ø®Ø´ Ø§ØµÙ„Ø§Ø­ Ø´Ø¯Ù‡
    if (selectionDisplayBack) {
        selectionDisplayBack.addEventListener('click', () => {
            closeSelectionDisplay();
            setTimeout(() => {
                selectionListPanel.classList.add('open');
                overlay.classList.add('active');
                document.body.style.overflow = 'hidden';
            }, 300);
        });
    }

    // ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ Ú¯Ø§Ø±Ø³ÙˆÙ†
    if (selectionDisplayCall) {
        selectionDisplayCall.addEventListener('click', () => {
            showNotification('Ú¯Ø§Ø±Ø³ÙˆÙ† Ø¨Ù‡ Ù…ÛŒØ² Ø´Ù…Ø§ ÙØ±Ø§Ø®ÙˆØ§Ù†Ø¯Ù‡ Ø´Ø¯');
            setTimeout(() => {
                closeSelectionDisplay();
            }, 2000);
        });
    }

    // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù„ÛŒØ³Øª
    if (selectionListClear) {
        selectionListClear.addEventListener('click', () => {
            if (selectedFoods.length === 0) {
                showNotification('Ù„ÛŒØ³Øª Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ù…Ø§ Ø§Ø² Ù‚Ø¨Ù„ Ø®Ø§Ù„ÛŒ Ø§Ø³Øª');
                return;
            }

            if (confirm('Ø¢ÛŒØ§ Ø§Ø² Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù„ÛŒØ³Øª Ø§Ù†ØªØ®Ø§Ø¨ Ø®ÙˆØ¯ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ')) {
                selectedFoods = [];
                saveSelectionList();
                updateSelectionList();
                updateOrderButtons();
                showNotification('Ù„ÛŒØ³Øª Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ù…Ø§ Ù¾Ø§Ú© Ø´Ø¯');
            }
        });
    }

    // Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ overlay
    if (overlay) {
        overlay.addEventListener('click', function() {
            // Ø§Ú¯Ø± Ù¾Ù†Ù„ Ù„ÛŒØ³Øª Ø¨Ø§Ø² Ø§Ø³ØªØŒ Ø¢Ù† Ø±Ø§ Ø¨Ø¨Ù†Ø¯
            if (selectionListPanel.classList.contains('open')) {
                closeSelectionListPanel();
            }
            // Ø§Ú¯Ø± ØµÙØ­Ù‡ Ù†Ù…Ø§ÛŒØ´ Ø¨Ø§Ø² Ø§Ø³ØªØŒ Ø¢Ù† Ø±Ø§ Ø¨Ø¨Ù†Ø¯
            if (selectionDisplay.classList.contains('open')) {
                closeSelectionDisplay();
            }
        });
    }

    // Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø³ÙØ§Ø±Ø´
    document.addEventListener('click', (e) => {
        // Ø³ÙØ§Ø±Ø´ ØºØ°Ø§
        if (e.target.closest('.order-btn')) {
            handleOrderButtonClick(e.target.closest('.order-btn'));
        }

        // Ù…Ø¯ÛŒØ±ÛŒØª ØªØ¹Ø¯Ø§Ø¯
        if (e.target.closest('.quantity-btn')) {
            handleQuantityButtonClick(e.target.closest('.quantity-btn'));
        }

        // Ø­Ø°Ù Ø¢ÛŒØªÙ…
        if (e.target.closest('.selection-list-item-remove')) {
            handleRemoveItemClick(e.target.closest('.selection-list-item-remove'));
        }
    });

    function handleOrderButtonClick(orderBtn) {
        const foodId = orderBtn.getAttribute('data-food-id');
        const foodTitle = orderBtn.getAttribute('data-food-title');
        const foodPrice = parseInt(orderBtn.getAttribute('data-food-price'));
        const foodImage = orderBtn.getAttribute('data-food-image');

        const existingIndex = selectedFoods.findIndex(item => item.id === foodId);

        if (existingIndex === -1) {
            selectedFoods.push({
                id: foodId,
                title: foodTitle,
                price: foodPrice,
                image: foodImage,
                quantity: 1
            });

            orderBtn.classList.add('added');
            orderBtn.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg"
                     viewBox="0 0 512 512"
                     width="14"
                     height="14"
                     fill="currentColor"
                     style="margin-left: 4px;">
                    <path d="M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"/>
                </svg>
                <span class="order-text">Ø³ÙØ§Ø±Ø´ Ø´Ø¯Ù‡</span>
            `;

            showNotification(`"${foodTitle}" Ø¨Ù‡ Ù„ÛŒØ³Øª Ø§Ù†ØªØ®Ø§Ø¨ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯`);
        } else {
            selectedFoods[existingIndex].quantity += 1;
            showNotification(`ØªØ¹Ø¯Ø§Ø¯ "${foodTitle}" Ø¨Ù‡ ${selectedFoods[existingIndex].quantity} Ø§ÙØ²Ø§ÛŒØ´ ÛŒØ§ÙØª`);
        }

        saveSelectionList();
        updateSelectionList();
    }

    function handleQuantityButtonClick(quantityBtn) {
        const foodItem = quantityBtn.closest('.selection-list-item');
        if (!foodItem) return;

        const removeBtn = foodItem.querySelector('.selection-list-item-remove');
        if (!removeBtn) return;

        const foodId = removeBtn.getAttribute('data-food-id');
        const isIncrease = quantityBtn.classList.contains('increase');

        const existingIndex = selectedFoods.findIndex(item => item.id === foodId);
        if (existingIndex !== -1) {
            const foodTitle = selectedFoods[existingIndex].title;

            if (isIncrease) {
                selectedFoods[existingIndex].quantity += 1;
                showNotification(`ØªØ¹Ø¯Ø§Ø¯ "${foodTitle}" Ø§ÙØ²Ø§ÛŒØ´ ÛŒØ§ÙØª`);
            } else {
                if (selectedFoods[existingIndex].quantity > 1) {
                    selectedFoods[existingIndex].quantity -= 1;
                    showNotification(`ØªØ¹Ø¯Ø§Ø¯ "${foodTitle}" Ú©Ø§Ù‡Ø´ ÛŒØ§ÙØª`);
                } else {
                    selectedFoods.splice(existingIndex, 1);
                    showNotification(`"${foodTitle}" Ø§Ø² Ù„ÛŒØ³Øª Ø§Ù†ØªØ®Ø§Ø¨ Ø­Ø°Ù Ø´Ø¯`);
                    updateOrderButtons();
                }
            }

            saveSelectionList();
            updateSelectionList();
        }
    }

    function handleRemoveItemClick(removeBtn) {
        const foodId = removeBtn.getAttribute('data-food-id');
        const existingIndex = selectedFoods.findIndex(item => item.id === foodId);

        if (existingIndex !== -1) {
            const foodTitle = selectedFoods[existingIndex].title;
            selectedFoods.splice(existingIndex, 1);

            saveSelectionList();
            updateSelectionList();
            updateOrderButtons();

            showNotification(`"${foodTitle}" Ø§Ø² Ù„ÛŒØ³Øª Ø§Ù†ØªØ®Ø§Ø¨ Ø­Ø°Ù Ø´Ø¯`);
        }
    }
}

    // ==================== ØªÙˆØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ Ù„ÛŒØ³Øª Ø§Ù†ØªØ®Ø§Ø¨ ====================
    function saveSelectionList() {
        localStorage.setItem('selectedFoods_' + restaurantSlug, JSON.stringify(selectedFoods));
    }

    function updateSelectionList() {
        const badge = document.querySelector('.selection-list-badge');
        const selectionListItems = document.querySelector('.selection-list-items');
        const selectionListEmpty = document.querySelector('.selection-list-empty');

        if (!badge || !selectionListItems || !selectionListEmpty) return;

        const totalItems = selectedFoods.reduce((total, food) => total + food.quantity, 0);
        badge.textContent = totalItems;

        if (selectedFoods.length === 0) {
            selectionListEmpty.style.display = 'flex';
            selectionListItems.innerHTML = '';
        } else {
            selectionListEmpty.style.display = 'none';

            let itemsHTML = '';
            selectedFoods.forEach(food => {
                itemsHTML += `
                    <div class="selection-list-item">
                        ${food.image ?
                            `<img src="${food.image}" alt="${food.title}" class="selection-list-item-image">` :
                            `<div class="selection-list-item-image bg-gradient-to-br from-gray-200 to-gray-300 flex items-center justify-center text-gray-400">
                                <i class="fas fa-utensils"></i>
                            </div>`
                        }
                        <div class="selection-list-item-details">
                            <div class="selection-list-item-title">${food.title}</div>
                            <div class="selection-list-item-price">${food.price.toLocaleString()} ØªÙˆÙ…Ø§Ù†</div>
                            <div class="selection-list-item-quantity">
                                <div class="quantity-btn decrease">-</div>
                                <div class="quantity-value">${food.quantity}</div>
                                <div class="quantity-btn increase">+</div>
                            </div>
                        </div>
                        <div class="selection-list-item-remove" data-food-id="${food.id}">
                           <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 352 512" width="14" height="14" fill="currentColor">
    <path d="M242.7 256l100.1-100.1c12.3-12.3 12.3-32.2 0-44.5l-22.2-22.2c-12.3-12.3-32.2-12.3-44.5 0L176 189.3 75.9 89.2c-12.3-12.3-32.2-12.3-44.5 0L9.2 111.4c-12.3 12.3-12.3 32.2 0 44.5L109.3 256 9.2 356.1c-12.3 12.3-12.3 32.2 0 44.5l22.2 22.2c12.3 12.3 32.2 12.3 44.5 0L176 322.7l100.1 100.1c12.3 12.3 32.2 12.3 44.5 0l22.2-22.2c12.3-12.3 12.3-32.2 0-44.5L242.7 256z"/>
</svg>
                        </div>
                    </div>
                `;
            });

            selectionListItems.innerHTML = itemsHTML;
        }
    }

    function updateOrderButtons() {
    const orderBtns = document.querySelectorAll('.order-btn');
    orderBtns.forEach(btn => {
        const foodId = btn.getAttribute('data-food-id');
        const isSelected = selectedFoods.some(food => food.id === foodId);

        if (isSelected) {
            btn.classList.add('added');
            btn.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg"
                     viewBox="0 0 512 512"
                     width="14"
                     height="14"
                     fill="currentColor"
                     style="margin-left: 4px;">
                    <path d="M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"/>
                </svg>
                <span class="order-text">Ø³ÙØ§Ø±Ø´ Ø´Ø¯Ù‡</span>
            `;
        } else {
            btn.classList.remove('added');
            btn.innerHTML = '<span class="order-text">Ø³ÙØ§Ø±Ø´</span>';
        }
    });
}

    function updateSelectionDisplay() {
        const selectionDisplayItems = document.querySelector('.selection-display-items');
        const selectionDisplayTotal = document.querySelector('.selection-display-total-price');

        if (!selectionDisplayItems || !selectionDisplayTotal) return;

        let itemsHTML = '';
        let totalPrice = 0;

        selectedFoods.forEach(food => {
            const foodTotal = food.price * food.quantity;
            totalPrice += foodTotal;

            itemsHTML += `
                <div class="selection-display-item">
                    ${food.image ?
                        `<img src="${food.image}" alt="${food.title}" class="selection-display-item-image">` :
                        `<div class="selection-display-item-image bg-gradient-to-br from-gray-200 to-gray-300 flex items-center justify-center text-gray-400">
                            <i class="fas fa-utensils"></i>
                        </div>`
                    }
                    <div class="selection-display-item-details">
                        <div class="selection-display-item-title">${food.title}</div>
                        <div class="selection-display-item-price">${food.price.toLocaleString()} ØªÙˆÙ…Ø§Ù†</div>
                        <div class="selection-display-item-quantity">ØªØ¹Ø¯Ø§Ø¯: ${food.quantity}</div>
                    </div>
                </div>
            `;
        });

        selectionDisplayItems.innerHTML = itemsHTML;
        selectionDisplayTotal.textContent = totalPrice.toLocaleString() + ' ØªÙˆÙ…Ø§Ù†';
    }

    // ==================== Ù…Ø¯ÛŒØ±ÛŒØª Ø±Ø²Ø±Ùˆ ====================
    function initializeReservation() {
        // ÙˆÙ‚ØªÛŒ Ù…ÙˆØ¯Ø§Ù„ Ø¨Ø§Ø² Ù…ÛŒâ€ŒØ´ÙˆØ¯
        const reservationModal = document.getElementById('reservationModal');
        if (reservationModal) {
            reservationModal.addEventListener('show.bs.modal', function () {
                resetReservationForm();
            });
        }

        // Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ ÙÛŒÙ„Ø¯Ù‡Ø§
        const phoneNumber = document.getElementById('phoneNumber');
        const nationalCode = document.getElementById('nationalCode');
        const confirmationCode = document.getElementById('confirmationCode');

        if (phoneNumber) {
            phoneNumber.addEventListener('input', function(e) {
                this.value = this.value.replace(/[^0-9]/g, '');
            });
        }

        if (nationalCode) {
            nationalCode.addEventListener('input', function(e) {
                this.value = this.value.replace(/[^0-9]/g, '');
            });
        }

        if (confirmationCode) {
            confirmationCode.addEventListener('input', function(e) {
                this.value = this.value.replace(/[^0-9]/g, '');
            });
        }
    }

    // Ø¨Ø§Ø²Ù†Ø´Ø§Ù†ÛŒ ÙØ±Ù… Ø±Ø²Ø±Ùˆ
    function resetReservationForm() {
        currentReservation = {
            tableId: null,
            date: null,
            startTime: null,
            endTime: null,
            guestCount: 2,
            reservationCode: null
        };

        document.getElementById('reservationDate').value = '';
        document.getElementById('guestCount').value = '2';
        document.getElementById('fullName').value = '';
        document.getElementById('phoneNumber').value = '';
        document.getElementById('nationalCode').value = '';
        document.getElementById('specialRequests').value = '';
        document.getElementById('confirmationCode').value = '';

        showStep(1);
    }

    // Ù†Ù…Ø§ÛŒØ´ Ù…Ø±Ø­Ù„Ù‡ Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± Ø±Ø²Ø±Ùˆ
    function showStep(stepNumber) {
        document.getElementById('step1').classList.add('hidden');
        document.getElementById('step2').classList.add('hidden');
        document.getElementById('step3').classList.add('hidden');
        document.getElementById('step4').classList.add('hidden');
        document.getElementById(`step${stepNumber}`).classList.remove('hidden');
    }

    // Ø¨Ø±Ø±Ø³ÛŒ Ø¯Ø³ØªØ±Ø³ÛŒ Ø±Ø²Ø±Ùˆ
    function checkAvailability() {
        const date = document.getElementById('reservationDate').value.trim();
        const guestCount = document.getElementById('guestCount').value;

        if (!date) {
            showAlert('Ù„Ø·ÙØ§ ØªØ§Ø±ÛŒØ® Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯', 'error');
            return;
        }

        if (!/^\d{4}\/\d{2}\/\d{2}$/.test(date)) {
            showAlert('ÙØ±Ù…Øª ØªØ§Ø±ÛŒØ® Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª. Ù…Ø«Ø§Ù„: 1403/01/01', 'error');
            return;
        }

        currentReservation.date = date;
        currentReservation.guestCount = guestCount;

        // Ù†Ù…Ø§ÛŒØ´ Ù„ÙˆØ¯ÛŒÙ†Ú¯
        document.getElementById('availabilityResults').innerHTML = `
            <div class="text-center py-8">
                <div class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"></div>
                <p class="text-gray-600 mt-3">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ø±Ø³ÛŒ Ø¯Ø³ØªØ±Ø³ÛŒ Ù…ÛŒØ²Ù‡Ø§...</p>
            </div>
        `;

        // Ø¯Ø±Ø®ÙˆØ§Ø³Øª AJAX Ø¯Ø§ÛŒÙ†Ø§Ù…ÛŒÚ©
        fetch(`/table/{{ restaurant.slug }}/check-availability/?date=${date}&guest_count=${guestCount}`)
            .then(response => response.json())
            .then(data => {
                if (data.available) {
                    showAvailabilityResults(data.tables);
                    showStep(2);
                } else {
                    document.getElementById('availabilityResults').innerHTML = `
                        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 text-center">
                            <i class="fas fa-info-circle text-yellow-500 text-xl mb-2"></i>
                            <p class="text-yellow-700">${data.message || 'Ù…ØªØ£Ø³ÙØ§Ù†Ù‡ Ø¯Ø± Ø§ÛŒÙ† ØªØ§Ø±ÛŒØ® Ù…ÛŒØ² Ø®Ø§Ù„ÛŒ Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛŒØ³Øª'}</p>
                        </div>
                    `;
                }
            })
            .catch(error => {
                console.error('Error:', error);
                document.getElementById('availabilityResults').innerHTML = `
                    <div class="bg-red-50 border border-red-200 rounded-lg p-4 text-center">
                        <i class="fas fa-exclamation-circle text-red-500 text-xl mb-2"></i>
                        <p class="text-red-700">Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø±Ø±Ø³ÛŒ Ø¯Ø³ØªØ±Ø³ÛŒ</p>
                    </div>
                `;
            });
    }

    // Ù†Ù…Ø§ÛŒØ´ Ù†ØªØ§ÛŒØ¬ Ø¯Ø³ØªØ±Ø³ÛŒ Ø±Ø²Ø±Ùˆ
    function showAvailabilityResults(tables) {
        if (tables.length === 0) {
            document.getElementById('availabilityResults').innerHTML = `
                <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 text-center">
                    <i class="fas fa-info-circle text-yellow-500 text-xl mb-2"></i>
                    <p class="text-yellow-700">Ù‡ÛŒÚ† Ù…ÛŒØ²ÛŒ Ø¨Ø±Ø§ÛŒ ØªØ§Ø±ÛŒØ® Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡ Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛŒØ³Øª</p>
                </div>
            `;
            return;
        }

        let html = '<div class="space-y-4">';

        tables.forEach(table => {
            html += `
                <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
                    <div class="flex justify-between items-start mb-3">
                        <div>
                            <h6 class="font-semibold text-gray-800">Ù…ÛŒØ² ${table.table_number}</h6>
                            <p class="text-sm text-gray-600">Ø¸Ø±ÙÛŒØª: ${table.capacity} Ù†ÙØ± â€¢ Ù†ÙˆØ¹: ${table.table_type}</p>
                            <p class="text-xs text-blue-600 mt-1">Ø³Ø§Ø¹Ø§Øª Ú©Ø§Ø±ÛŒ: ${table.working_hours}</p>
                        </div>
                        <span class="bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full">
                            ${table.available_slots.length} Ø§Ø³Ù„Ø§Øª Ø¢Ø²Ø§Ø¯
                        </span>
                    </div>
                    <div class="flex flex-wrap gap-2 max-h-40 overflow-y-auto p-2 bg-gray-50 rounded-lg">
            `;

            table.available_slots.forEach(slot => {
                const isEvening = parseInt(slot.start.split(':')[0]) >= 16;
                const timeClass = isEvening
                    ? 'bg-purple-100 border-purple-300 text-purple-700 hover:bg-purple-200'
                    : 'bg-white border-orange-200 text-orange-600 hover:bg-orange-50';

                html += `
                    <button type="button"
                            class="slot-btn ${timeClass} border px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 shadow-sm hover:shadow-md"
                            onclick="selectTimeSlot(${table.id}, '${slot.start}', '${slot.end}', '${slot.display}')">
                        ${slot.display}
                        ${isEvening ? 'ğŸŒ™' : 'â˜€ï¸'}
                    </button>
                `;
            });

            html += `
                    </div>
                </div>
            `;
        });

        html += '</div>';
        document.getElementById('availabilityResults').innerHTML = html;
    }

    // Ø§Ù†ØªØ®Ø§Ø¨ Ø²Ù…Ø§Ù† Ø±Ø²Ø±Ùˆ
    function selectTimeSlot(tableId, startTime, endTime, displayTime) {
        const formatTime = (timeStr) => {
            if (timeStr.length === 5) {
                return timeStr + ':00';
            }
            return timeStr;
        };

        currentReservation.tableId = tableId;
        currentReservation.startTime = formatTime(startTime);
        currentReservation.endTime = formatTime(endTime);

        showAlert(`Ø²Ù…Ø§Ù† ${displayTime} Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯`, 'success');
        showStep(3);
    }

    // Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ø±Ø­Ù„Ù‡ Û± Ø±Ø²Ø±Ùˆ
    function backToStep1() {
        showStep(1);
    }

    // Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ø±Ø­Ù„Ù‡ Û² Ø±Ø²Ø±Ùˆ
    function backToStep2() {
        showStep(2);
    }

    // Ø«Ø¨Øª Ø±Ø²Ø±Ùˆ
    function submitReservation() {
        const fullName = document.getElementById('fullName').value.trim();
        const phoneNumber = document.getElementById('phoneNumber').value.trim();

        if (!fullName || !phoneNumber) {
            showAlert('Ù„Ø·ÙØ§ Ù†Ø§Ù… Ú©Ø§Ù…Ù„ Ùˆ Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯', 'error');
            return;
        }

        if (phoneNumber.length < 10) {
            showAlert('Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³ Ø¨Ø§ÛŒØ¯ Ø­Ø¯Ø§Ù‚Ù„ Û±Û° Ø±Ù‚Ù… Ø¨Ø§Ø´Ø¯', 'error');
            return;
        }

        const formData = new FormData();
        formData.append('table_id', currentReservation.tableId);
        formData.append('reservation_date', currentReservation.date);
        formData.append('start_time', currentReservation.startTime);
        formData.append('end_time', currentReservation.endTime);
        formData.append('guest_count', currentReservation.guestCount);
        formData.append('full_name', fullName);
        formData.append('phone_number', phoneNumber);
        formData.append('national_code', document.getElementById('nationalCode').value.trim());
        formData.append('special_requests', document.getElementById('specialRequests').value.trim());

        // Ù†Ù…Ø§ÛŒØ´ Ù„ÙˆØ¯ÛŒÙ†Ú¯
        showStep(4);
        document.getElementById('successMessage').innerHTML = `
            <div class="text-center py-4">
                <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500 mb-3"></div>
                <p class="text-gray-600">Ø¯Ø± Ø­Ø§Ù„ Ø«Ø¨Øª Ø±Ø²Ø±Ùˆ...</p>
            </div>
        `;

        // Ø¯Ø±Ø®ÙˆØ§Ø³Øª AJAX Ø¯Ø§ÛŒÙ†Ø§Ù…ÛŒÚ©
        fetch(`/table/{{ restaurant.slug }}/create-reservation/`, {
            method: 'POST',
            body: formData,
            headers: {
                'X-CSRFToken': '{{ csrf_token }}'
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                currentReservation.reservationCode = data.reservation_code;
                showSuccessMessage(data);
            } else {
                showStep(3);
                showAlert(data.message, 'error');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            showStep(3);
            showAlert('Ø®Ø·Ø§ Ø¯Ø± Ø«Ø¨Øª Ø±Ø²Ø±Ùˆ', 'error');
        });
    }

    // Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù… Ù…ÙˆÙÙ‚ÛŒØª Ø±Ø²Ø±Ùˆ
    function showSuccessMessage(data) {
        document.getElementById('successMessage').innerHTML = `
            <h6 class="font-semibold text-gray-800 mb-2">âœ… Ø±Ø²Ø±Ùˆ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø«Ø¨Øª Ø´Ø¯</h6>
            <p class="text-sm text-gray-600 mb-1">Ú©Ø¯ Ø±Ø²Ø±Ùˆ: <span class="font-mono font-bold text-orange-600">${data.reservation_code}</span></p>
            <p class="text-sm text-gray-600">Ú©Ø¯ ØªØ£ÛŒÛŒØ¯: <span class="font-mono font-bold text-green-600">${data.confirmation_code}</span></p>
            <p class="text-xs text-gray-500 mt-2">Ú©Ø¯ ØªØ£ÛŒÛŒØ¯ Ø¨Ø±Ø§ÛŒ ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ø±Ø²Ø±Ùˆ Ù„Ø§Ø²Ù… Ø§Ø³Øª</p>
        `;

        document.getElementById('verificationSection').classList.remove('hidden');
    }

    // ØªØ£ÛŒÛŒØ¯ Ø±Ø²Ø±Ùˆ
    function verifyReservation() {
        const confirmationCode = document.getElementById('confirmationCode').value.trim();

        if (!confirmationCode || confirmationCode.length !== 6) {
            showAlert('Ù„Ø·ÙØ§ Ú©Ø¯ ØªØ£ÛŒÛŒØ¯ Û¶ Ø±Ù‚Ù…ÛŒ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯', 'error');
            return;
        }

        fetch(`/table/verify/${currentReservation.reservationCode}/`, {
            method: 'POST',
            body: JSON.stringify({ confirmation_code: confirmationCode }),
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': '{{ csrf_token }}'
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                document.getElementById('verificationSection').classList.add('hidden');
                document.getElementById('verifiedSection').classList.remove('hidden');
                document.getElementById('finalMessage').innerHTML = `
                    Ø±Ø²Ø±Ùˆ Ø´Ù…Ø§ Ø¨Ø§ Ú©Ø¯ <span class="font-mono font-bold">${currentReservation.reservationCode}</span>
                    ØªØ£ÛŒÛŒØ¯ Ø´Ø¯. Ù…Ù†ØªØ¸Ø± Ø­Ø¶ÙˆØ± Ø´Ù…Ø§ Ù‡Ø³ØªÛŒÙ…!
                `;

                // Ø¨Ø³ØªÙ† Ø®ÙˆØ¯Ú©Ø§Ø± Ù…ÙˆØ¯Ø§Ù„ Ø¨Ø¹Ø¯ Ø§Ø² Û³ Ø«Ø§Ù†ÛŒÙ‡
                setTimeout(() => {
                    const modal = bootstrap.Modal.getInstance(document.getElementById('reservationModal'));
                    modal.hide();
                }, 3000);
            } else {
                showAlert(data.message, 'error');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            showAlert('Ø®Ø·Ø§ Ø¯Ø± ØªØ£ÛŒÛŒØ¯ Ø±Ø²Ø±Ùˆ', 'error');
        });
    }

    // ==================== ØªÙˆØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ ====================
    function showNotification(message) {
        const existingNotification = document.querySelector('.notification');
        if (existingNotification) {
            existingNotification.remove();
        }

        const notification = document.createElement('div');
        notification.className = 'notification fixed top-20 left-1/2 transform -translate-x-1/2 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50 text-sm';
        notification.textContent = message;
        document.body.appendChild(notification);

        setTimeout(() => {
            notification.remove();
        }, 3000);
    }

    function showAlert(message, type = 'info') {
        const alertClass = {
            'success': 'bg-green-50 border-green-200 text-green-700',
            'error': 'bg-red-50 border-red-200 text-red-700',
            'info': 'bg-blue-50 border-blue-200 text-blue-700',
            'warning': 'bg-yellow-50 border-yellow-200 text-yellow-700'
        }[type];

        const iconClass = {
            'success': 'fa-check-circle',
            'error': 'fa-exclamation-circle',
            'info': 'fa-info-circle',
            'warning': 'fa-exclamation-triangle'
        }[type];

        const alertDiv = document.createElement('div');
        alertDiv.className = `fixed top-4 right-4 ${alertClass} border rounded-lg p-4 shadow-lg z-50 max-w-sm`;
        alertDiv.innerHTML = `
            <div class="flex items-center gap-2">
                <i class="fas ${iconClass}"></i>
                <span>${message}</span>
            </div>
        `;

        document.body.appendChild(alertDiv);

        setTimeout(() => {
            alertDiv.remove();
        }, 5000);
    }

    // ==================== Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ ====================
    document.addEventListener('DOMContentLoaded', function() {
        initializeTheme();
        initializeCategories();
        initializeSearch();
        initializeCategoriesSlider();
        initializeSound();
        initializeSelectionList();
        initializeReservation();

        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ Ù„ÛŒØ³Øª Ø§Ù†ØªØ®Ø§Ø¨
        updateSelectionList();
        updateOrderButtons();

        // ØªÙˆÙ‚Ù Ù¾Ø®Ø´ ØµØ¯Ø§ ÙˆÙ‚ØªÛŒ ØµÙØ­Ù‡ Ø¨Ø³ØªÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
        window.addEventListener('beforeunload', () => {
            if (currentAudio && !currentAudio.paused) {
                currentAudio.pause();
            }
        });
    });
</script>