{% load static %}
{% load humanize %}

<section class="section" id="pricing">
    <div class="container">
        <div class="section-title">
            <span style='font-size: 2.5rem;
  font-weight: bold;
  color: #1e293b;
  margin-bottom: 0.5rem;'>پلن‌های قیمت‌گذاری</span>
            <p>انتخاب بهترین طرح متناسب با نیاز رستوران شما.</p>
        </div>

        <div class="pricing-grid">
            {% for plan in plans %}
            <div class="price-card {% if plan.is_recommended %}featured{% endif %}">
                {% if plan.is_recommended %}
                <div class="featured-tag">{{ plan.recommended_tag|default:"پیشنهادی" }}</div>
                {% endif %}

                <div class="price-name">{{ plan.name }}</div>

                <div class="price-val">
                    {% if plan.price == 0 %}
                        رایگان
                    {% elif plan.price %}
                        {{ plan.price|intcomma }}
                    {% else %}
                        تماس
                    {% endif %}
                </div>

                <span class="price-unit">
                    {% if plan.price == 0 %}
                        برای همیشه
                    {% elif plan.price %}
                        تومان / {{ plan.duration }}
                    {% else %}
                        {{ plan.description|default:"برای رستوران‌های زنجیره‌ای" }}
                    {% endif %}
                </span>

                <ul class="price-features">
                    {% for feature in plan.features.all %}
                    <li {% if not feature.is_available %}style="color: var(--text-light);"{% endif %}>
                        {% if feature.is_available %}
                            {{ feature.title }}
                        {% else %}
                            {{ feature.title }}
                        {% endif %}
                    </li>
                    {% endfor %}
                </ul>

                {% if plan.price == 0 %}
                    <a href="{% url 'plan:start_free_plan' plan.slug %}" class="btn btn-secondary" style="width: 100%;">شروع کنید</a>
                {% elif plan.price %}
                    <a href="{% url 'plan:purchase_plan' plan.slug %}" class="btn {% if plan.is_recommended %}btn-primary{% else %}btn-secondary{% endif %}" style="width: 100%;">
                        {% if plan.is_recommended %}خرید اشتراک{% else %}انتخاب پلن{% endif %}
                    </a>
                {% else %}
                    <a href="{% url 'contact:sales' %}" class="btn btn-secondary" style="width: 100%;">تماس با فروش</a>
                {% endif %}
            </div>
            {% empty %}
            <div class="no-plans-message">
                <p>در حال حاضر پلنی برای نمایش وجود ندارد.</p>
            </div>
            {% endfor %}
        </div>
    </div>
</section>